# AD Lab 2

## Obtain situational awareness

whoami&#x20;

whoami /groups

Get-LocalUser&#x20;

Get-LocalGroup

Get-LocalGroupMember ITGroup

systeminfo

ipconfig /all&#x20;

route print

Takes a little bit longer, so it was commented out

netstat -ano

Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname

## Get-Process

## Search for sensitive information on Windows systems

## Get-ChildItem -Path C:\ -Include \*.kdbx -File -Recurse -ErrorAction SilentlyContinue

## Get-ChildItem -Path C:\xampp -Include _.txt,_.ini -File -Recurse -ErrorAction SilentlyContinue

## Get-ChildItem -Path C:\Users\Administrator\ -Include _.txt,_.pdf,_.xls,_.xlsx,_.doc,_.docx -File -Recurse -ErrorAction SilentlyContinue

## type C:\xampp\passwords.txt

## type C:\xampp\mysql\bin\my.ini

## Find sensitive information generated by PowerShell

## Get-History

## (Get-PSReadlineOption).HistorySavePath

type "C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\Windows PowerShell ISE Host\_history.txt"

## Automated enumeration tools

## Winpeas

## Hijack service binaries

Get-Service | where {$\_.Status -eq 'Running'}

Get-CimInstance -ClassName win32\_service | Select Name,State,PathName | Where-Object {$\_.State -like 'Running'}

## icacls "C:\xampp\apache\bin\httpd.exe"

## icacls "C:\xampp\mysql\bin\mysqld.exe"

## icacls "C:\xampp\mysql\bin\mysqld.exe"
