# Medusa

Medusa, a prominent tool in the cybersecurity arsenal, is designed to be a fast, massively parallel, and modular login brute-forcer. Its primary objective is to support a wide array of services that allow remote authentication, enabling penetration testers and security professionals to assess the resilience of login systems against brute-force attacks.

## Installation

Medusa often comes pre-installed on popular penetration testing distributions. You can verify its presence by running:

```shell-session
$ medusa -h
```

Installing Medusa on a Linux system is straightforward.

```shell-session
$ sudo apt-get -y update
$ sudo apt-get -y install medusa
```

## Command Syntax and Parameter Table

Medusa's command-line interface is straightforward. It allows users to specify hosts, users, passwords, and modules with various options to fine-tune the attack process.

```shell-session
$ medusa [target_options] [credential_options] -M module [module_options]
```

<table><thead><tr><th width="128.0909423828125">Parameter</th><th width="301.727294921875">Explanation</th><th>Usage Example</th></tr></thead><tbody><tr><td><code>-h HOST</code> or <code>-H FILE</code></td><td>Target options: Specify either a single target hostname or IP address (<code>-h</code>) or a file containing a list of targets (<code>-H</code>).</td><td><code>medusa -h 192.168.1.10 ...</code> or <code>medusa -H targets.txt ...</code></td></tr><tr><td><code>-u USERNAME</code> or <code>-U FILE</code></td><td>Username options: Provide either a single username (<code>-u</code>) or a file containing a list of usernames (<code>-U</code>).</td><td><code>medusa -u admin ...</code> or <code>medusa -U usernames.txt ...</code></td></tr><tr><td><code>-p PASSWORD</code> or <code>-P FILE</code></td><td>Password options: Specify either a single password (<code>-p</code>) or a file containing a list of passwords (<code>-P</code>).</td><td><code>medusa -p password123 ...</code> or <code>medusa -P passwords.txt ...</code></td></tr><tr><td><code>-M MODULE</code></td><td>Module: Define the specific module to use for the attack (e.g., <code>ssh</code>, <code>ftp</code>, <code>http</code>).</td><td><code>medusa -M ssh ...</code></td></tr><tr><td><code>-m "MODULE_OPTION"</code></td><td>Module options: Provide additional parameters required by the chosen module, enclosed in quotes.</td><td><code>medusa -M http -m "POST /login.php HTTP/1.1\r\nContent-Length: 30\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\nusername=^USER^&#x26;password=^PASS^" ...</code></td></tr><tr><td><code>-t TASKS</code></td><td>Tasks: Define the number of parallel login attempts to run, potentially speeding up the attack.</td><td><code>medusa -t 4 ...</code></td></tr><tr><td><code>-f</code> or <code>-F</code></td><td>Fast mode: Stop the attack after the first successful login is found, either on the current host (<code>-f</code>) or any host (<code>-F</code>).</td><td><code>medusa -f ...</code> or <code>medusa -F ...</code></td></tr><tr><td><code>-n PORT</code></td><td>Port: Specify a non-default port for the target service.</td><td><code>medusa -n 2222 ...</code></td></tr><tr><td><code>-v LEVEL</code></td><td>Verbose output: Display detailed information about the attack's progress. The higher the <code>LEVEL</code> (up to 6), the more verbose the output.</td><td><code>medusa -v 4 ...</code></td></tr></tbody></table>

### Medusa Modules

Each module in Medusa is tailored to interact with specific authentication mechanisms, allowing it to send the appropriate requests and interpret responses for successful attacks. Below is a table of commonly used modules:

<table><thead><tr><th width="117.90911865234375">Medusa Module</th><th width="159.09088134765625">Service/Protocol</th><th width="214.0909423828125">Description</th><th>Usage Example</th></tr></thead><tbody><tr><td>FTP</td><td>File Transfer Protocol</td><td>Brute-forcing FTP login credentials, used for file transfers over a network.</td><td><code>medusa -M ftp -h 192.168.1.100 -u admin -P passwords.txt</code></td></tr><tr><td>HTTP</td><td>Hypertext Transfer Protocol</td><td>Brute-forcing login forms on web applications over HTTP (GET/POST).</td><td><code>medusa -M http -h www.example.com -U users.txt -P passwords.txt -m DIR:/login.php -m FORM:username=^USER^&#x26;password=^PASS^</code></td></tr><tr><td>IMAP</td><td>Internet Message Access Protocol</td><td>Brute-forcing IMAP logins, often used to access email servers.</td><td><code>medusa -M imap -h mail.example.com -U users.txt -P passwords.txt</code></td></tr><tr><td>MySQL</td><td>MySQL Database</td><td>Brute-forcing MySQL database credentials, commonly used for web applications and databases.</td><td><code>medusa -M mysql -h 192.168.1.100 -u root -P passwords.txt</code></td></tr><tr><td>POP3</td><td>Post Office Protocol 3</td><td>Brute-forcing POP3 logins, typically used to retrieve emails from a mail server.</td><td><code>medusa -M pop3 -h mail.example.com -U users.txt -P passwords.txt</code></td></tr><tr><td>RDP</td><td>Remote Desktop Protocol</td><td>Brute-forcing RDP logins, commonly used for remote desktop access to Windows systems.</td><td><code>medusa -M rdp -h 192.168.1.100 -u admin -P passwords.txt</code></td></tr><tr><td>SSHv2</td><td>Secure Shell (SSH)</td><td>Brute-forcing SSH logins, commonly used for secure remote access.</td><td><code>medusa -M ssh -h 192.168.1.100 -u root -P passwords.txt</code></td></tr><tr><td>Subversion (SVN)</td><td>Version Control System</td><td>Brute-forcing Subversion (SVN) repositories for version control.</td><td><code>medusa -M svn -h 192.168.1.100 -u admin -P passwords.txt</code></td></tr><tr><td>Telnet</td><td>Telnet Protocol</td><td>Brute-forcing Telnet services for remote command execution on older systems.</td><td><code>medusa -M telnet -h 192.168.1.100 -u admin -P passwords.txt</code></td></tr><tr><td>VNC</td><td>Virtual Network Computing</td><td>Brute-forcing VNC login credentials for remote desktop access.</td><td><code>medusa -M vnc -h 192.168.1.100 -P passwords.txt</code></td></tr><tr><td>Web Form</td><td>Brute-forcing Web Login Forms</td><td>Brute-forcing login forms on websites using HTTP POST requests.</td><td><code>medusa -M web-form -h www.example.com -U users.txt -P passwords.txt -m FORM:"username=^USER^&#x26;password=^PASS^:F=Invalid"</code></td></tr></tbody></table>

### Targeting an SSH Server

Imagine a scenario where you need to test the security of an SSH server at `192.168.0.100`. You have a list of potential usernames in `usernames.txt` and common passwords in `passwords.txt`. To launch a brute-force attack against the SSH service on this server, use the following Medusa command:

```shell-session
$ medusa -h 192.168.0.100 -U usernames.txt -P passwords.txt -M ssh 
```

This command instructs Medusa to:

* Target the host at `192.168.0.100`.
* Use the usernames from the `usernames.txt` file.
* Test the passwords listed in the `passwords.txt` file.
* Employ the `ssh` module for the attack.

Medusa will systematically try each username-password combination against the SSH service to attempt to gain unauthorized access.

### Targeting Multiple Web Servers with Basic HTTP Authentication

Suppose you have a list of web servers that use basic HTTP authentication. These servers' addresses are stored in `web_servers.txt`, and you also have lists of common usernames and passwords in `usernames.txt` and `passwords.txt`, respectively. To test these servers concurrently, execute:

```shell-session
$ medusa -H web_servers.txt -U usernames.txt -P passwords.txt -M http -m GET
```

In this case, Medusa will:

* Iterate through the list of web servers in `web_servers.txt`.
* Use the usernames and passwords provided.
* Employ the `http` module with the `GET` method to attempt logins.

By running multiple threads, Medusa efficiently checks each server for weak credentials.

### Testing for Empty or Default Passwords

If you want to assess whether any accounts on a specific host (`10.0.0.5`) have empty or default passwords (where the password matches the username), you can use:

```shell-session
$ medusa -h 10.0.0.5 -U usernames.txt -e ns -M service_name
```

This command instructs Medusa to:

* Target the host at `10.0.0.5`.
* Use the usernames from `usernames.txt`.
* Perform additional checks for empty passwords (`-e n`) and passwords matching the username (`-e s`).
* Use the appropriate service module (replace `service_name` with the correct module name).

Medusa will try each username with an empty password and then with the password matching the username, potentially revealing accounts with weak or default configurations.
